- project:
    name: build
    plugin_name:
      - contrail:
          plugin_repo: fuel-plugin-contrail
          email_to: omartsyniuk@mirantis.com, vstruk@mirantis.com
      - vpnass:
          plugin_repo: fuel-plugin-neutron-vpnaas
          email_to: aepifanov@mirantis.com
      - fwaas:
          plugin_repo: fuel-plugin-neutron-fwaas
          email_to: aepifanov@mirantis.com
      - lma:
          plugin_repo: fuel-plugin-lma-collector
          email_to: tnurlygayanov@mirantis.com, ppetit@mirantis.com, spasquier@mirantis.com
      - eskibana:
          plugin_repo: fuel-plugin-elasticsearch-kibana
          email_to: tnurlygayanov@mirantis.com, ppetit@mirantis.com, spasquier@mirantis.com
      - zabbix:
          plugin_repo: fuel-plugin-external-zabbix
          email_to: dklenov@mirantis.com, dkalashnik@mirantis.com, pmisiak@mirantis.com
      - emc:
          plugin_repo: fuel-plugin-external-emc
          email_to: dklenov@mirantis.com, dkalashnik@mirantis.com, pmisiak@mirantis.com
    jobs:
      - '{plugin_name}.build'

- job-template:
    name: '{plugin_name}.build'
    builders:
      - shell:
          !include-raw './builders/syntax-build-plugin.sh'
    description: '<a href=https://github.com/stackforge/{plugin_repo}>Build {plugin_name} plugin from fuel-plugins project</a>'
    logrotate:
      numToKeep: 10
    node: tpi71
    scm:
      - git:
          branches:
            - $GERRIT_BRANCH
          name: ''
          refspec: $GERRIT_REFSPEC
          url: 'https://review.openstack.org/stackforge/{plugin_repo}'
          choosing-strategy: gerrit
          clean:
            before: true
          skip-tag: true
          wipe-workspace: false
    triggers:
      - gerrit:
          trigger-on:
            - patchset-created-event:
                exclude-drafts: true
                exclude-trivial-rebase: true
                exclude-no-code-change: true
          projects:
            - project-compare-type: 'PLAIN'
              project-pattern: 'stackforge/{plugin_repo}'
              branches:
                - branch-compare-type: 'ANT'
                  branch-pattern: '**'
          skip-vote:
            successful: true
            failed: true
            unstable: true
            notbuilt: true
          silent: true
          escape-quotes: true
          trigger-for-unreviewed-patches: true
          server-name: 'review.openstack.org'
    publishers:
      - archive:
          artifacts: '*.rpm'
      - email:
          notify-every-unstable-build: true
          recipients: 'khontar@mirantis.com, {email_to}'
          send-to-individuals: true
